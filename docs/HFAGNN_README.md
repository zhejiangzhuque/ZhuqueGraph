This repository is to predict **molecular property**, **the HOMO-LUMO gap**, on dataset [PCQM4Mv2 OGB-LSC](https://ogb.stanford.edu/neurips2022/). We also use 3D structure of molecules generated by [RDKit](https://rdkit.org/). 

## Requirements
```
python==3.8.13
rdkit==2022.03.2
pytorch==1.12.0
torch-geometric==2.1.0
ogb==1.3.5
tensorboard==2.10.1
sympy==1.11.1
tqdm==4.64.1
```

## Training
Dataset will be downloaded automatically into `root` directory, like `root/pcqm4m-v2`.

```
python launch/hfagnn/HFAGNNtrain.py --root=data --gnn=HFAGNN --num_layers=6 --dropout=0.1 \
--batch_size=512 --emb_dim=256 --epochs=100 --lr=0.0005 --dist_url=tcp://127.0.0.1:28720 \
--num_workers=4
```

The total running time is about 24 hours with the above hyper-parameter settings.
> We use [Pytorch DDP (Distributed Data Parallel)](https://pytorch.org/tutorials/intermediate/ddp_tutorial.html) to accelerate the training process. You can specify GPUs in enviroment variables.

## Results
Test-challenge MAE: 0.1008, leaderboard rank: 11 ([OGB-LSC 2022 PCQM4Mv2](https://ogb.stanford.edu/neurips2022/results/#winners_pcqm4mv2))

Test-dev MAE: 0.1005, leaderboard rank: 19 (until 2023/01/03)

